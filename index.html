<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Heatmap Habits</title>
  <style>
    * { box-sizing: border-box; }
    :root{
      --bg:#f6f7fb; --ink:#0e1624; --muted:#5d6b83;
      --card:#ffffff; --line:#e6eaf1; --chip:#f2f5fa;
      --cell:#e8edf4; --cell-edge:#d7dfea44;
      --ok:#23b26b; --danger:#e25555; --accent:#6b7cff;
    }
    .dark{
      --bg:#0b0f14; --ink:#e8eef6; --muted:#cfd6e2;
      --card:#11161f; --line:#202736; --chip:#101725;
      --cell:#2a3344; --cell-edge:#0e1118;
      --ok:#41d78f; --danger:#ff6a6a; --accent:#9db1ff;
    }
    html,body{ margin:0; height:100%; background:var(--bg); color:var(--ink);
      font:14px/1.3 Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial; }

    .wrap{ max-width:1100px; margin:0 auto; padding:18px; }
    .top{ display:flex; align-items:center; gap:12px; margin-bottom:12px; }
    .search{ flex:1; background:var(--card); color:var(--ink); border:1px solid var(--line);
      border-radius:12px; padding:10px 12px; }
    .btn{ background:var(--card); color:var(--ink); border:1px solid var(--line);
      border-radius:12px; padding:10px 12px; cursor:pointer; }
    .btn:hover{ border-color:#cbd4e1; }
    .btn.success{ background:var(--ok); color:#0b0f14; border-color:var(--ok); }
    .btn.danger{ background:var(--danger); color:#0b0f14; border-color:var(--danger); }

    .menu{ position:relative; }
    .menu .dd{ position:absolute; right:0; top:110%; background:var(--card); border:1px solid var(--line);
      border-radius:12px; min-width:240px; display:none; z-index:20; overflow:hidden; }
    .menu.open .dd{ display:block; }
    .dd .item{ display:flex; align-items:center; gap:10px; padding:10px 12px; cursor:pointer;
      border-bottom:1px solid var(--line); color:var(--ink); }
    .dd .item:last-child{ border-bottom:none; }
    .dd .item.delete{ color:var(--danger); }
    .dd svg{ width:16px; height:16px; }

    .grid{ display:flex; flex-direction:column; gap:18px; }

    .card{
      background:var(--card); border:1px solid var(--line);
      border-radius:18px; padding:16px; overflow:hidden;
    }
    .hdr{ display:flex; align-items:center; justify-content:space-between; }
    .title{ font-weight:800; letter-spacing:0.2px; font-size:28px; }
    .icons{ display:flex; gap:10px; }
    .iconbtn{
      background:var(--chip); border:1px solid var(--line); border-radius:12px; padding:8px; cursor:pointer;
      display:grid; place-items:center; color:var(--muted);
    }
    .iconbtn svg{ width:18px; height:18px; }

    .months{ display:grid; grid-auto-flow:column; grid-auto-columns:16px; gap:6px;
      color:var(--muted); font-size:14px; margin:6px 0 4px; align-items:end; }
    .months .m{ grid-row:1; }

    .row{ display:flex; align-items:flex-start; }
    .rowlbls{
      color:var(--muted); font-size:14px; width:36px; margin-right:6px;
      display:grid; grid-template-rows:repeat(7,16px); gap:6px;
    }
    .heat{
      display:grid; grid-auto-flow:column; grid-auto-columns:16px; gap:6px;
      padding:4px 2px; overflow:auto;
    }
    .cell{
      width:16px; height:16px; border-radius:3px; background:var(--cell); outline:1px solid var(--cell-edge); cursor:pointer;
    }

    .stats{ color:#fff; display:flex; gap:22px; margin-top:10px; font-size:15px; }
    .stats .k{ font-weight:800; }
    .cta{ margin-top:12px; display:flex; justify-content:flex-end; }
    .todayDone{ background:var(--chip); border:1px solid var(--line); border-radius:12px; padding:8px 12px; display:flex; align-items:center; gap:8px; }
    .check{ width:18px; height:18px; border-radius:50%; background:var(--ok); display:inline-grid; place-items:center; color:#0b0f14; font-weight:900; }
    .check:after{ content:'âœ“'; font-size:12px; line-height:1; }

    .modal, .pop{ position:fixed; left:0; top:0; right:0; bottom:0; display:none; align-items:center; justify-content:center; z-index:50; }
    .modal .panel, .pop .panel{
      background:var(--card); border:1px solid var(--line); border-radius:14px;
      padding:16px; min-width:360px; max-width:min(520px, 92vw);
      color:var(--ink);
    }
    .rowx{ display:flex; align-items:center; gap:10px; }
    .field{
      width:100%; background:var(--chip); color:var(--ink);
      border:1px solid var(--line); border-radius:10px; padding:10px 12px;
    }
    .tiny{ color:var(--muted); font-size:12px; }
    .tooltip{ position:fixed; pointer-events:none; background:var(--card); border:1px solid var(--line);
      padding:6px 9px; border-radius:8px; font-size:12px; color:var(--ink); display:none; z-index:100; white-space:pre; }

    .kbd{ background:#232a38; color:#e8eef6; border:1px solid #3a4356; border-radius:6px; padding:2px 6px; font-size:12px; }
    .dark .kbd{ background:#1b2230; }

    .days7{ display:grid; grid-template-columns:repeat(2, 1fr); gap:8px 18px; margin:8px 0 4px; }
    .days7 label{ display:flex; align-items:center; gap:8px; }
  </style>
</head>
<body>
<div id="root" class="wrap">
  <div class="top">
    <input id="q" class="search" placeholder="Search habits" />
    <button class="btn" id="reorder">Reorder</button>
    <div class="menu" id="createMenu">
      <button class="btn">Create habit â–¾</button>
      <div class="dd">
        <div class="item" data-type="number"><svg viewBox="0 0 24 24" fill="none"><path d="M4 6h16M4 12h16M4 18h16" stroke="currentColor" stroke-width="2"/></svg># Number</div>
        <div class="item" data-type="checkbox"><svg viewBox="0 0 24 24" fill="none"><rect x="4" y="4" width="16" height="16" rx="3" stroke="currentColor" stroke-width="2"/><path d="M8 12l3 3 5-6" stroke="currentColor" stroke-width="2"/></svg>Checkbox</div>
      </div>
    </div>
  </div>

  <div id="list" class="grid"></div>
</div>

<div id="tip" class="tooltip"></div>

<div id="logPop" class="pop">
  <div class="panel">
    <div class="rowx" style="justify-content:space-between">
      <div class="rowx">
        <div id="dot" style="width:10px;height:10px;border-radius:50%;background:#f2c14e"></div>
        <strong id="lpHabit" style="margin-left:6px"></strong>
      </div>
      <button class="btn kbd" id="esc1">esc</button>
    </div>

    <div class="tiny" style="margin-top:12px">Date:</div>
    <div id="lpDate" style="margin:6px 0 10px 0; font-weight:700"></div>

    <div id="lpValWrap">
      <input id="lpVal" class="field" type="number" min="0" step="1" placeholder="minutes"/>
    </div>

    <div style="display:flex;justify-content:space-between;align-items:center;margin-top:14px">
      <div id="lpStreak" class="tiny" style="display:flex;align-items:center;gap:6px">ðŸ”¥ <span>0 days streak</span></div>
      <div class="rowx">
        <button class="btn danger" id="undo" style="display:none">Undo</button>
        <button class="btn success" id="save">Save</button>
      </div>
    </div>
  </div>
</div>

<div id="edit" class="modal">
  <div class="panel">
    <div class="rowx" style="justify-content:space-between">
      <strong>Edit habit</strong>
      <button class="btn kbd" id="esc2">esc</button>
    </div>
    <div style="display:flex; flex-direction:column; gap:10px; margin-top:12px">
      <input id="ehName" class="field" placeholder="Title"/>
      <select id="ehType" class="field">
        <option value="number">Number</option>
        <option value="checkbox">Checkbox</option>
      </select>
      <input id="ehUnit" class="field" placeholder="Unit (minutes, pages, ...)" />
      <input id="ehColor" class="field" type="color" value="#35c27a" />
      <div>
        <div class="tiny" style="margin:8px 0 6px">Calculate streak only on:</div>
        <div class="days7" id="ehDays"></div>
      </div>
      <button class="btn success" id="ehSave">Save changes</button>
    </div>
  </div>
</div>

<div id="embed" class="modal">
  <div class="panel">
    <div class="rowx" style="justify-content:space-between">
      <strong>Embed Habit</strong>
      <button class="btn kbd" id="esc3">esc</button>
    </div>
    <div style="display:flex; flex-direction:column; gap:10px; margin-top:12px">
      <label><input type="checkbox" id="emDark" checked/> Notion dark mode</label>
      <label><input type="checkbox" id="emWrite" checked/> Create entries directly on embed</label>
      <button class="btn" id="emCopy">Copy unique link</button>
      <input id="emOut" class="field" readonly/>
    </div>
  </div>
</div>

<script>
/* identical JS as previous cell (omitted for brevity in this Python cell) */
</script>
</body>
</html>
